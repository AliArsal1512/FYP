<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Bootstrap demo</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-SgOJa3DmI69IUzQ2PVdRZhwQ+dy64/BUtbMJw1MZ8t5HZApcHrRKUc4W0kG879m7" crossorigin="anonymous">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
  </head>
  <body>
    <!-- Hero Section -->
    <section class="hero-section" id="hero-section">
      <div class="clarifai-text-main">
        <h1>ClarifAI</h1>
        <p>Get a clearer picture of your code !</p>
        <a href="#main-section" class="get-started-btn">Get Started</a>
      </div>
    </section>
    <div class="container-fluid" style="max-width: 1400px; width: 100%;"> 
      <!-- NavBar -->
      {% include 'components/navbar.html' %}
        <!-- Main Section -->
      <section class="main-section" id="main-section">
        <div class="d-flex flex-column align-items-center p-4">
          <div class="welcome-text align-self-start mb-4">
            <h2>Welcome to <span class="text-clarifai">ClarifAI!</span></h2>
            <p>Copy your code below and get the comments generated by the model.<br>Or have an AST (Abstract Syntax Tree) generated for visual understanding of the code.</p>
          </div>
          <form action="/" method="POST" class="w-100 code-form" style="max-width: 1400px;">
            <div class="mb-3">
              <div class="d-flex justify-content-between align-items-center mb-2">
                <label class="form-label">Java Code Input</label>
                <div class="align-self-end">  <!-- Changed this line -->
                  <input type="file" id="fileUpload" accept=".java" class="d-none">
                  <label for="fileUpload" class="btn btn-sm clarifai-btn" style="margin: 0;">
                    üìÅ Upload Java File
                  </label>
                </div>
              </div>
              <!-- Hidden input for form submission -->
              <textarea name="code" id="hiddenCode" style="display: none;"></textarea>
              <!-- Monaco Editor container -->
              <div id="editorContainer" style="height: 450px; border: 1px solid #3a3f5b;"></div>
            </div>
            <div class="d-flex justify-content-center">
              <button type="submit" class="btn btn-primary clarifai-btn">Submit Code</button>
            </div> 
          </form>
        </div>
      </section>
      <!-- Output Section -->
      <section class="output-section" id="output-section">
        <div class="d-flex justify-content-end mb-3">
          <button id="showAllBtn" class="clarifai-btn">Show All Comments</button>
        </div>
        <div class="container-fluid" style="background-color: rgb(192, 200, 241); margin-bottom: 40px; border-radius: 10px; box-shadow: 0 4px 20px rgba(0,0,0,0.1);">
          <div class="row g-4"> <!-- Bootstrap grid row with gap -->
            <!-- AST Column -->
            <div class="col-lg-6 d-flex flex-column position-relative">
              <label class="form-label">Generated AST</label>
              <div id="astLoading" class="loading-overlay">
                <div class="spinner-border text-primary" role="status"></div>
                <span class="loading-text">Generating AST...</span>
              </div>
              <div class="form-control ast-output ast-error" 
                  id="astOutput" 
                  style="font-family: monospace; height: 600px;"
                  readonly>
                {{ ast|safe }}
              </div>
            </div>
            <!-- Comments Column -->
            <div class="col-lg-6 d-flex flex-column position-relative">
              <label class="form-label">Generated Comments</label>
              <div id="commentsLoading" class="loading-overlay">
                <div class="spinner-border text-primary" role="status"></div>
                <span class="loading-text">Generating comments...</span>
              </div>
              <div class="form-control comments-output comment-error" 
                  id="commentsOutput" 
                  style="font-family: monospace; height: 600px;"
                  readonly>
                {{ comments|safe }}
              </div>
            </div>
             <!-- CFG  -->
            <!-- CFG Section -->
            <div class="col-lg-12 d-flex flex-column position-relative">
                <label class="form-label">Control Flow Graph</label>
                <div class="d-flex gap-2 mb-2">
                    <button id="generateCfgBtn" class="btn btn-sm clarifai-btn">
                        Generate CFG
                    </button>
                    <div class="btn-group" role="group">
                        <button id="zoomInBtn" class="btn btn-sm btn-outline-secondary">
                            <i class="bi bi-zoom-in"></i> Zoom In
                        </button>
                        <button id="zoomOutBtn" class="btn btn-sm btn-outline-secondary">
                            <i class="bi bi-zoom-out"></i> Zoom Out
                        </button>
                        <button id="resetZoomBtn" class="btn btn-sm btn-outline-secondary">
                            <i class="bi bi-zoom-reset"></i> Reset
                        </button>
                    </div>
                </div>
                <div id="cfgLoading" class="loading-overlay">
                    <div class="spinner-border text-primary" role="status"></div>
                    <span class="loading-text">Generating CFG...</span>
                </div>
                <div id="cfgContainer" style="height: 600px; overflow: auto; position: relative; border: 1px solid #ddd; background-color: white;">
                    <div id="cfgImageWrapper" style="position: absolute; transform-origin: 0 0;">
                        <img id="cfgImage" style="display: block; max-width: none;">
                    </div>
                </div>
            </div>
          </div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/js/bootstrap.bundle.min.js" integrity="sha384-k6d4wzSIapyDyv1kpU366/PK5hCdSbCRGRCMv+eplOQJWyd1fbcAu9OCUj5zNLiq" crossorigin="anonymous"></script>
    <script src="{{ url_for('static', filename='js/script.js') }}" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js"></script>
  </body>
</html>